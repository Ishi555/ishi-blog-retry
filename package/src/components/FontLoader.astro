---
// source: https://fonts.zeoseven.com/items/2/
// this script used to load "LXGW ZhenKai" font
// provide three ways to load font: only-en, full, dynamic by JS

import config from "charm:config"

let mode = "disabled";

if (config.font === "auto" ) mode = config.lang.toLowerCase().startsWith("en") ? "only-en" : "full";
else if ( config.font === "only-en" ) mode = "only-en";
else if (config.font === "full" ) mode = "full";
else if (config.font === "dynamic") mode = "dynamic";
---

{ mode ===  "only-en" && (
  <style is:inline is:global>
    @font-face {
      font-family: 'LXGW ZhenKai';
      src: url('https://static.zeoseven.com/zsft/2/main.woff2') format('woff2'),
          url('https://static-host.zeoseven.com/zsft/2/main.woff2') format('woff2');
      unicode-range: U+0061-007A, U+0041-005A, U+0030-0039, U+002E, U+002C, U+0021, U+003F, U+003A, U+003B, U+002D;
    }
  </style>
)}

{ mode === "full" && (
  <link
    rel="preconnect"
    href="https://static.zeoseven.com"
    crossorigin="anonymous"
  />
  <style is:inline is:global>
    @import url("https://static.zeoseven.com/zsft/2/main/result.css");
  </style>
)}

{ /* ZSFT 超小~型 CSS 冗余器 Version 2 (LICENSE: MIT, by Qiu, zeoseven.com), CDN 载入出错时直接由源服务器提供文件 */ }
{ mode === "dynamic" && (
  <link
    rel="preconnect"
    href="https://static.zeoseven.com"
    crossorigin="anonymous"
  />
  <link
    rel="preload"
    as="style"
    href="https://static.zeoseven.com/zsft/2/main/result.css"
  />
  <script is:inline lang="javascript" data-astro-rerun>
    // prettier-ignore
    ((z,s,f,t)=>{setTimeout(()=>{let a=(b, c)=>{
    if(s===0){let d=document.createElement('link');d.rel='stylesheet';d.type='text/css';d.href="https://static" + b + "zeoseven.com/zsft/2/main/result.css";
        d.onerror=function(){document.head.removeChild(d);a(c);s++;};document.head.appendChild(d);};};a(z[0],z[1]);t.fontFamily=f;t.fontWeight='normal';
    },0);})(['.','-host.'],0,"LXGW ZhenKai",document.documentElement.style);
  </script>
)}
